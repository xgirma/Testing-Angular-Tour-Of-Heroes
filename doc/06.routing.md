# Routing
Add route. 

## Add the AppRoutingModule
### :zap: router: app-routing.module.ts
```typescript
import { NgModule } from '@angular/core';
import { RouterModule, Routes } from '@angular/router';

import { HeroesComponent } from './heroes/heroes.component';

const routes: Routes = [
  { path: 'heroes', component: HeroesComponent }
];

@NgModule({
  imports: [RouterModule.forRoot(routes)],
  exports: [RouterModule]
})
export class AppRoutingModule { }
```

### :pig: view: app.component.html
```diff
<h1>{{title}}</h1>
<app-heroes></app-heroes>
<app-messages></app-messages>
```

:heavy_multiplication_x: unit test: 21 specs, 4 failures

:heavy_multiplication_x: e2e test: Executed 9 of 9 specs (8 FAILED)

### :cat: unit test: error: app.component.spec.ts
```text
Failed: Template parse errors:
'router-outlet' is not a known element:
1. If 'router-outlet' is an Angular component, then verify that it is part of this module.
2. If 'router-outlet' is a Web Component then add 'CUSTOM_ELEMENTS_SCHEMA' to the '@NgModule.schemas' of this component to suppress this message. ("<h1>{{title}}</h1>
[ERROR ->]<router-outlet></router-outlet>
<app-messages></app-messages>
"): ng:///DynamicTestModule/AppComponent.html@1:0
```

### :cat: unit test: app.component.spec.ts
```diff
import { TestBed, async, ComponentFixture } from '@angular/core/testing';
import { FormsModule } from '@angular/forms';
+ import { RouterTestingModule } from '@angular/router/testing';

import { AppComponent } from './app.component';
import { HeroesComponent } from './heroes/heroes.component';
import { HeroDetailComponent } from './hero-detail/hero-detail.component';
import { MessagesComponent } from './messages/messages.component';

describe('AppComponent', () => {
  let component: AppComponent;
  let fixture: ComponentFixture<AppComponent>;
  let compiled: any;

  beforeEach(async(() => {
    TestBed.configureTestingModule({
      imports: [
+        RouterTestingModule,
        FormsModule
      ],
      declarations: [
        AppComponent,
        HeroesComponent,
        HeroDetailComponent,
        MessagesComponent
      ],
    }).compileComponents();
  }));

  beforeEach(() => {
    fixture = TestBed.createComponent(AppComponent);
    component = fixture.componentInstance;
    fixture.detectChanges();
    compiled = fixture.debugElement.nativeElement;
  });

  it('should create the app', () => {
    expect(component).toBeTruthy();
  });

  it(`should have as title 'Tour of Heroes'`, () => {
    expect(component.title).toEqual('Tour of Heroes');
  });

  it('should have app-heroes element', () => {
    expect(compiled.querySelector('app-heroes')).toBeDefined();
  });

  it('should have app-messages element', () => {
    expect(compiled.querySelector('app-messages')).toBeDefined();
  });
});
```
:heavy_check_mark: unit test: 21 specs, 0 failures

:heavy_multiplication_x: e2e test: Executed 9 of 9 specs (8 FAILED)

At this point, even if the view only shows the title of the application. All unit tests are passing. In contrast, 
the e2e test are failing, as there is no view to interact with.

### :pig: view: app.component.html
```diff
<h1>{{title}}</h1>
<nav>
  <a routerLink="/heroes">Heroes</a>
</nav>
<router-outlet></router-outlet>
<app-messages></app-messages>
```
:heavy_check_mark: unit test: 21 specs, 0 failures

:heavy_multiplication_x: e2e test: Executed 9 of 9 specs (8 FAILED)

### :cat: unit test: app.component.spec.ts
```diff
import { TestBed, async, ComponentFixture } from '@angular/core/testing';
import { FormsModule } from '@angular/forms';
import { RouterTestingModule } from '@angular/router/testing';

import { AppComponent } from './app.component';
import { HeroesComponent } from './heroes/heroes.component';
import { HeroDetailComponent } from './hero-detail/hero-detail.component';
import { MessagesComponent } from './messages/messages.component';

describe('AppComponent', () => {
  let component: AppComponent;
  let fixture: ComponentFixture<AppComponent>;
  let compiled: any;

  beforeEach(async(() => {
    TestBed.configureTestingModule({
      imports: [
        RouterTestingModule,
        FormsModule
      ],
      declarations: [
        AppComponent,
        HeroesComponent,
        HeroDetailComponent,
        MessagesComponent
      ],
    }).compileComponents();
  }));

  beforeEach(() => {
    fixture = TestBed.createComponent(AppComponent);
    component = fixture.componentInstance;
    fixture.detectChanges();
    compiled = fixture.debugElement.nativeElement;
  });

  it('should create the app', () => {
    expect(component).toBeTruthy();
  });

+  it(`should have as title 'Tour of Heroes'`, () => {
+    expect(component.title).toEqual('Tour of Heroes');
+  });

+  it(`should have nav to '/heroes`, () => {
+    expect(compiled.querySelector('nav > a')
+      .getAttribute('href')).toEqual('/heroes');
+  });

  it('should have router-outlet element', () => {
    expect(compiled.querySelector('router-outlet')).toBeTruthy();
  });

  it('should have app-messages element', () => {
    expect(compiled.querySelector('app-messages')).toBeTruthy();
  });
});
```

### :dog: e2e test: heroes.po.ts
```diff
import { browser, by, element, ExpectedConditions as EC } from 'protractor';

export class AppHeroes {
  body = element(by.css('body'));
  title = element(by.css('app-heroes > h2'));
  list = element.all(by.css('.heroes > li'));

  navigateTo() {
-    browser.get(browser.baseUrl);
+    browser.get(browser.baseUrl + `/heroes`);
    return browser.wait(EC.presenceOf(this.body), 5000) as Promise< void>;
  }

  getTitle() {
    return this.title.getText() as Promise<string>;
  }

  getHeroDetail(index) {
    return this.list.get(index).getText() as Promise<string>;
  }

  selectHero(index) {
    return this.list.get(index).click() as Promise<any>;
  }
}
```

### :dog: e2e test: message.e2e-spec.ts
```diff
- import { AppPage } from './app.po';
+ import { AppHeroes } from './heroes.po';
import { Messages } from './messages.po';

describe('Messages', () => {
-  let appPage: AppPage;
+  let appHeroes: AppHeroes;
  let message: Messages;

  beforeAll(() => {
-    appPage = new AppPage();
+    appHeroes = new AppHeroes();
    message = new Messages();
-    appPage.navigateTo();
+    appHeroes.navigateTo();
  });

  it('should have message title', () => {
    expect(message.getTitle()).toEqual('Messages');
  });

  it('should have message', () => {
    expect(message.getMessage()).toEqual('HeroService: fetched heroes');
  });

  it('should clear message', () => {
    message.clickClear();
    expect(message.title.isPresent()).toBeFalsy();
    expect(message.clear.isPresent()).toBeFalsy();
    expect(message.message.isPresent()).toBeFalsy();
  });
});
```

:heavy_check_mark: unit test: 21 specs, 0 failures

:heavy_check_mark: e2e test: Executed 9 of 9 specs SUCCESS


