# Services
Component shouldn't fetch or save data directly. Get the data from `HeroService`.

## HeroService

### :ant: service: hero.service.ts
```typescript
import { Injectable } from '@angular/core';

import { Hero } from './hero';
import { HEROES } from './mock-heroes';

@Injectable({
  providedIn: 'root'
})
export class HeroService {

  constructor() { }

  getHeroes(): Hero[] {
    return HEROES;
  }
}
```

### :cow: component: heroes.component.ts
```diff
import { Component, OnInit } from '@angular/core';

import { Hero } from '../hero';
- import { HEROES } from '../mock-heroes';
+ import { HeroService } from '../hero.service';

@Component({
  selector: 'app-heroes',
  templateUrl: './heroes.component.html',
  styleUrls: ['./heroes.component.css']
})
export class HeroesComponent implements OnInit {
-  heroes = HEROES;
  selectedHero: Hero;
  heroes: Hero[];

  constructor(
+    private heroService: HeroService
  ) { }

  ngOnInit() {
 +   this.getHeroes();
  }
  
+  getHeroes(): void {
+    this.heroes = this.heroService.getHeroes();
+  }

  onSelect(hero: Hero): void {
    this.selectedHero = hero;
  }
}
```

### :cat: unit test: hero.service.spec.ts
```typescript
import { TestBed } from '@angular/core/testing';

import { HeroService } from './hero.service';
import { HEROES } from './mock-heroes';

describe('HeroService', () => {
  let heroService: HeroService;

  beforeEach(() => {
    TestBed.configureTestingModule({});
    heroService = TestBed.get(HeroService);
  });

  it('should be created', () => {
    expect(heroService).toBeTruthy();
  });

  it('should have heroes', () => {
    expect(heroService.getHeroes()).toEqual(HEROES);
  });
});
```

:heavy_check_mark: unit test: 13 specs, 0 failures

:heavy_check_mark: e2e test: Executed 6 of 6 specs SUCCESS

Getting the data from the `HeroService` did not break the test.

## Observable data

### :ant: service: hero.service.ts
```diff
import { Injectable } from '@angular/core';
+ import { Observable, of } from 'rxjs';

import { Hero } from './hero';
import { HEROES } from './mock-heroes';

@Injectable({
  providedIn: 'root'
})
export class HeroService {

  constructor() { }

-  getHeroes(): Hero[] {
-    return HEROES;
-  }

+  getHeroes(): Observable<Hero[]> {
+    return of(HEROES);
+  }
}
```

### :cow: component: heroes.component.ts
```diff
import { Component, OnInit } from '@angular/core';

import { Hero } from '../hero';
import { HeroService } from '../hero.service';

@Component({
  selector: 'app-heroes',
  templateUrl: './heroes.component.html',
  styleUrls: ['./heroes.component.css']
})
export class HeroesComponent implements OnInit {
  selectedHero: Hero;
  heroes: Hero[];

  constructor(
    private heroService: HeroService
  ) { }

  ngOnInit() {
    this.getHeroes();
  }

-  getHeroes(): void {
-    this.heroes = this.heroService.getHeroes();
-  }

+  getHeroes(): void {
+    this.heroService.getHeroes()
+      .subscribe(heroes => this.heroes = heroes);
+  }

  onSelect(hero: Hero): void {
    this.selectedHero = hero;
  }
}
``` 

:heavy_multiplication_x: unit test: Executed 0 of 0 SUCCESS

:heavy_check_mark: e2e test: Executed 6 of 6 specs SUCCESS

### :cat: unit test: error: hero.service.spec.ts
```text
ERROR in src/app/hero.service.spec.ts:19:45 - error TS2345: Argument of type 'Hero[]' is not assignable to parameter of type 'Expected<Observable<Hero[]>>'.
  Type 'Hero[]' is missing the following properties from type '{ _isScalar: ExpectedRecursive<boolean>; source: ExpectedRecursive<Observable<any>>; operator: ExpectedRecursive<Operator<any, Hero[]>>; lift: ExpectedRecursive<(<R>(operator: Operator<Hero[], R>) => Observable<...>)>; ... 5 more ...; toPromise: ExpectedRecursive<...>; }': _isScalar, source, operator, lift, and 5 more.

19     expect(heroService.getHeroes()).toEqual(HEROES);
```
### :cat: unit test: hero.service.spec.ts

```diff
- import { TestBed } from '@angular/core/testing';
+ import { inject, TestBed } from '@angular/core/testing';

import { HeroService } from './hero.service';
import { HEROES } from './mock-heroes';

describe('HeroService', () => {
  let heroService: HeroService;

  beforeEach(() => {
    TestBed.configureTestingModule({});
    heroService = TestBed.get(HeroService);
  });

  it('should be created', () => {
    expect(heroService).toBeTruthy();
  });

-   it('should have heroes', () => {
-     expect(heroService.getHeroes()).toEqual(HEROES);
-   });

+  // tslint:disable-next-line:no-shadowed-variable
+  it(`get all heroes`, inject([HeroService], (heroService) => {
+    heroService.getHeroes().subscribe(heroes => {
+      expect(heroes).toEqual(HEROES);
+    });
+  }));
});
```

:heavy_check_mark: unit test: Executed 13 of 13 SUCCESS

:heavy_check_mark: e2e test: Executed 6 of 6 specs SUCCESS
